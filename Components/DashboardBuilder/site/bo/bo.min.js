var bo=window.bo={};!function(bo){"use strict";var DlgMediator=function(target,dispatcher,mediators,dlgs){var currdlg;dispatcher.addEventListener("changedlg",function(event){dispatcher.dispatch("changeoverlay",{typ:"show",duration:event.params.duration,opacity:event.params.opacity,cb:event.params.cb}),target.showdlg(event.params.duration),currdlg&&(currdlg.shutdown(),currdlg=null),event.params.id&&(currdlg=mediators.create(dlgs[event.params.id],target.element),currdlg.startup())}),dispatcher.addEventListener("loadcomplete",function(event){target.hidedlg(500),dispatcher.dispatch("changeoverlay",{typ:"hide",duration:500})})};bo.DlgMediator=DlgMediator}(bo),function(bo,d3){"use strict";var FileLoadMediator=function(target,dispatcher,datamodel){dispatcher.addEventListener("dataprogress",function(event){target.setprogress(event.params.id,event.params.pct)}),dispatcher.addEventListener("changefileload",function(event){switch(event.params.typ){case"setfiles":datamodel.fidx=event.params.fileidx,target.setdata(datamodel.files[event.params.fileidx].parts);break;case"startload":datamodel.startload();break;case"show":target.show(event.params.duration);break;case"hide":target.hide(event.params.duration)}})};bo.FileLoadMediator=FileLoadMediator}(bo,d3),function(bo,d3){"use strict";var OverlayMediator=function(target,dispatcher){dispatcher.addEventListener("changeoverlay",function(event){switch(event.params.typ){case"show":target.showolay(event.params.opacity,event.params.duration,function(){event.params.cb&&event.params.cb()});break;case"hide":target.hideolay(event.params.duration,function(){event.params.cb&&event.params.cb()})}})};bo.OverlayMediator=OverlayMediator}(bo,d3),function(bo,d3){"use strict";var DlgView=function(target,dispatcher){this.element=target,this.el=d3.select(target)};DlgView.prototype.showdlg=function(dur,cb){this.el.style({display:"",opacity:0}),this.el.transition().duration(dur||900).style("opacity",1).each("end",function(){cb&&cb()})},DlgView.prototype.hidedlg=function(dur,cb){var th;th=this,this.el.transition().duration(dur||900).style("opacity",0).each("end",function(){th.el.style("display","none"),cb&&cb()})},bo.DlgView=DlgView}(bo,d3),function(bo,d3,$){"use strict";var FileLoadView=function(target,dispatcher){this.element=d3.select(target),this.dispatcher=dispatcher,this.outer=this.element.append("div").attr("class","ds-1 fileloadview").style({width:"280px",margin:"40px auto",padding:"5px"}),this.filecontent=this.outer.append("div").attr("class","dlgfilecontent"),this.dat=[],this.prgcol="",this.size="small",this.datatype="json",this.fontcss="txtbold txtnorm",this.cbcomplete=null};FileLoadView.prototype.setdata=function(da){var th,pdiv,tdiv,bar,lbl;th=this,th.dat=da,th.filecontent.selectAll("div").remove(),_.forEach(th.dat,function(d,i){tdiv=th.filecontent.append("div").attr("class",th.fontcss),tdiv.text(d.displayname),pdiv=th.filecontent.append("div"),"small"===th.size?(pdiv.attr("id","_lprg"+d.idx).attr("class","ui tiny"+th.prgcol+" progress").style({height:"4px","margin-top":"4px","margin-bottom":"10px","border-radius":0}),bar=pdiv.append("div").attr("class","bar").style("height","4px"),$(pdiv.node()).progress({percent:0})):(pdiv.attr("id","_lprg"+d.idx).attr("class","ui "+th.prgcol+" progress").style({"margin-top":"4px","margin-bottom":"10px","border-radius":0}),bar=pdiv.append("div").attr("class","bar").append("div").attr("class","progress txtlight").style("background-color","transparent"),lbl=pdiv.append("div").attr("class","label"),$(pdiv.node()).progress({percent:0}))})},FileLoadView.prototype.setprogress=function(id,pct){$("#_lprg"+id).progress({percent:pct})},FileLoadView.prototype.show=function(dur){this.outer.style({display:"",opacity:0}),this.outer.transition().duration(dur).style("opacity",1)},FileLoadView.prototype.hide=function(dur){var th;th=this,this.outer.transition().duration(dur).style("opacity",0).each("end",function(){th.outer.style("display","none")})},bo.FileLoadView=FileLoadView}(bo,d3,$),function(bo,d3){"use strict";var OverlayView=function(target,dispatcher){this.element=d3.select(target)};OverlayView.prototype.showolay=function(op,dur,cb){this.element.style({display:"",opacity:0}),this.element.transition().duration(dur||900).style("opacity",op||1).each("end",function(){cb&&cb()})},OverlayView.prototype.hideolay=function(dur,cb){var th;th=this,this.element.transition().duration(dur||900).style("opacity",0).each("end",function(){th.element.style("display","none"),cb&&cb()})},bo.OverlayView=OverlayView}(bo,d3),function(bo){"use strict";bo.AppModel=function(){this.theme="light"}}(bo),function(bo,d3,_,queue){"use strict";bo.DataModel=function(dispatcher){var th;th=this,this.dispatcher=dispatcher,this.fidx=-1,this.ds=null,this.files=[{displayname:"intel data",multipart:!0,parts:[{displayname:"intel part 1",url:"../../data/inteldata2-001.csv",idx:0,typ:"csv"},{displayname:"intel part 2",url:"../../data/inteldata2-002.csv",idx:1,typ:"csv"}]}],this.loaddata=function(o,cb){d3[o.typ](o.url,function(d){o.dat=d,cb(null,"")}).on("progress",function(){if(d3.event.lengthComputable){var pct=Math.round(100*d3.event.loaded/d3.event.total);th.dispatcher.dispatch("dataprogress",{pct:pct,id:o.idx})}})}},bo.DataModel.prototype.startload=function(){var th,num,q;th=this,th.ds=null,th.ds=[],num=th.files[th.fidx].parts.length,num>4&&(num=4),q=queue(num),_.forEach(th.files[th.fidx].parts,function(d,i){d.dat=[],q.defer(th.loaddata,d)}),q.awaitAll(function(){_.forEach(th.files[th.fidx].parts,function(da){"csv"===da.typ&&th.files[th.fidx].multipart&&(th.ds=th.ds.concat(da.dat),da.dat=null)}),th.files[th.fidx].loaded=!0,th.dispatcher.dispatch("loadcomplete")})}}(bo,d3,_,queue),function(bo){"use strict";bo.AppDark=function(){this.bg={"background-color":"#333333"},this.olay={"background-color":"#888888"},this.fileloadview={"background-color":"#333333",color:"#eeeeee"}}}(bo),function(bo){"use strict";bo.AppLight=function(){this.bg={"background-color":"#ffffff"},this.olay={"background-color":"#444444"},this.fileloadview={"background-color":"#ffffff",color:"#444444"}}}(bo);